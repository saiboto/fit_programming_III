mm4
mm4 <- nls(dryweight.kg ~ a * d10^b, start = c(a = 0.35, b = 2.5))
mm4
mm4 <- nls(dryweight.kg ~ a * d12^b, start = c(a = 0.35, b = 2.5))
mm4
#models
attach(md)
plot(md§dryweight.kg ~ md$d01)
plot(md$dryweight.kg ~ md$d01)
plot(md$dryweight.kg ~ md$d01)
plot(md§dryweight.kg ~ md$d02)
plot(md$dryweight.kg ~ md$d01)
plot(md$dryweight.kg ~ md$d02)
plot(md$dryweight.kg ~ md$d04)
plot(md$dryweight.kg ~ md$d06)
plot(md$dryweight.kg ~ md$d08)
plot(md$dryweight.kg ~ md$d10)
plot(md$dryweight.kg ~ md$d12)
plot(md$dryweight.kg ~ md$Longitud)
plot(md$dryweight.kg ~ md$d01)
plot(md$dryweight.kg ~ md$d02)
plot(md$dryweight.kg ~ md$d04)
plot(md$dryweight.kg ~ md$d06)
plot(md$dryweight.kg ~ md$d08)
plot(md$dryweight.kg ~ md$d08)
plot(md$dryweight.kg ~ md$d08)
plot(md$dryweight.kg ~ md$d06)
plot(md$dryweight.kg ~ md$d08)
plot(md$dryweight.kg ~ md$d10)
plot(md$dryweight.kg ~ md$d12)
nls(dryweight.kg ~ a * d08^b, start = c(a = 0.35, b = 2.5))
nls(dryweight.kg ~ a * d10^b, start = c(a = 0.35, b = 2.5))
md <- md[ which(md$ID != 24),]
#models
attach(md)
mm1 <- nls(dryweight.kg ~ a * dap^b, start = c(a = 0.35, b = 2.5))
mm1
mm2 <- nls(dryweight.kg ~ a * altura_hipsometro^b, start = c(a = 0.3, b = 2))
mm2
mm3 <- nls(dryweight.kg ~ a * dap^b * altura_hipsometro ^c, start = c(a = 0.35, b = 1.5, c = 0.5))
mm3
mm4 <- nls(dryweight.kg ~ a * d10^b, start = c(a = 0.35, b = 2.5))
mm4
plot(md$dryweight.kg ~ md$d01)
plot(md$dryweight.kg ~ md$d02)
plot(md$dryweight.kg ~ md$d04)
plot(md$dryweight.kg ~ md$d06)
plot(md$dryweight.kg ~ md$d08)
plot(md$dryweight.kg ~ md$d10)
plot(md$dryweight.kg ~ md$d04)
plot(md$dryweight.kg ~ md$d06)
mm4 <- nls(dryweight.kg ~ a * d06^b, start = c(a = 0.35, b = 2.5))
mm4
mm4 <- nls(dryweight.kg ~ a * d08^b, start = c(a = 0.35, b = 2.5))
mm4
mm4 <- nls(dryweight.kg ~ a * d04^b, start = c(a = 0.35, b = 2.5))
mm4
mm4 <- nls(dryweight.kg ~ a * d06^b, start = c(a = 0.35, b = 2.5))
mm4
plot(md$dryweight.kg ~ md$d01)
plot(md$dryweight.kg ~ md$d02)
plot(md$dryweight.kg ~ md$d04)
plot(md$dryweight.kg ~ md$d06)
plot(md$dryweight.kg ~ md$d08)
plot(md$dryweight.kg ~ md$d10)
plot(md$dryweight.kg ~ md$d12)
#models
attach(md)
# plot ----
plot(md$dryweight.kg~md$dap, col = "darkred", pch = 20, xlim = c(0,18), ylim = c(0,80), xlab = "Diameter at breast height (cm)", ylab = "Culm Volume (dm^3)")
grid()
points(d$VolumenNetoSmallian*1000~d$DAP, col = "orange4", pch = 20)
lines(md$dbh, predict(mm1))
lines(md$dap, predict(mm1))
x <- seq(0,30,0.1)
mm1
lines(x,0.2715*x^2.0653) #mm1
# plot ----
plot(md$dryweight.kg~md$dap, col = "darkred", pch = 20, xlim = c(0,18), ylim = c(0,80), xlab = "Diameter at breast height (cm)", ylab = "Culm Volume (dm^3)")
grid()
points(d2$vol_dm3~d2$dap, col = "darkred", pch = 20)
lines(x,0.2715*x^2.0653) #mm1
points(md$dryweight.kg~md$dap, col = "darkred", pch = 20)
mm2 <- nls(dryweight.kg ~ a * altura_hipsometro^b, start = c(a = 0.3, b = 2))
mm2
lines(x,0.4255*x^1.685, col) #mm2
plot(md$dryweight.kg~md$altura_hipsometro, col = "darkred", pch = 20, xlim = c(0,18), ylim = c(0,80), xlab = "Diameter at breast height (cm)", ylab = "Culm Volume (dm^3)")
plot(md$dryweight.kg~md$altura_hipsometro, col = "darkred", pch = 20, xlim = c(0,18), ylim = c(0,80), xlab = "Laser height measurement (m)", ylab = "Culm Volume (dm^3)")
grid()
points(md$dryweight.kg~md$altura_hipsometro, col = "darkred", pch = 20)
lines(x,0.4255*x^1.685, col) #mm2
lines(x,0.4255*x^1.685) #mm2
plot(md$dryweight.kg~md$altura_hipsometro, col = "darkred", pch = 20, xlim = c(0,18), ylim = c(0,80), xlab = "Laser height measurement (m)", ylab = "Culm dry mass (kg)")
plot(md$dryweight.kg~md$dap, col = "darkred", pch = 20, xlim = c(0,18), ylim = c(0,80), xlab = "Diameter (cm)", ylab = "Culm dry mass (kg)")
grid()
points(md$dryweight.kg~md$dap, col = "darkred", pch = 20)
points(md$dryweight.kg~md$dap, col = "darkred", pch = 20)
points(md$dryweight.kg~md$d00, col = "black", pch = 20)
points(md$dryweight.kg~md$d02, col = "darkblue", pch = 20)
plot(md$dryweight.kg~md$dap, col = "darkred", pch = 20, xlim = c(0,18), ylim = c(0,80), xlab = "Diameter (cm)", ylab = "Culm dry mass (kg)")
plot(md$dryweight.kg~md$dap, col = "darkred", pch = 20, xlim = c(0,18), ylim = c(0,80), xlab = "Diameter (cm)", ylab = "Culm dry mass (kg)")
grid()
points(md$dryweight.kg~md$dap, col = "darkred", pch = 20)
md$d00
md$dap
md
asnumeric(md$d00)
points(md$dryweight.kg~as.numeric(md$d00)/10, col = "black", pch = 20)
as.numeric(md$d00)
points(md$dryweight.kg~as.numeric(md$d00, sep = ".")/10, col = "black", pch = 20)
as.numeric(md$d00, sep = ".")
points(md$dryweight.kg~md$d02/10, col = "darkblue", pch = 20)
md$d02
md$d02/10
points(md$dryweight.kg~md$d02/10, col = "darkblue", pch = 20)
points(md$dryweight.kg,md$d04/10, col = "cyan3", pch = 20)
md$dryweight.kg
points(md$dryweight.kg ~ (md$d04/10), col = "cyan3", pch = 20)
points(md$d04/10,md$dryweight.kg, col = "cyan3", pch = 20)
plot(md$dryweight.kg~md$dap, col = "darkred", pch = 20, xlim = c(0,18), ylim = c(0,80), xlab = "Diameter (cm)", ylab = "Culm dry mass (kg)")
grid()
points(md$dryweight.kg~md$dap, col = "darkred", pch = 20)
points(md$dryweight.kg~as.numeric(md$d00)/10, col = "black", pch = 20)
points(md$d02/10,md$dryweight.kg, col = "darkblue", pch = 20)
points(md$d04/10,md$dryweight.kg, col = "cyan3", pch = 20)
points(md$d06/10,md$dryweight.kg, col = "yellow4", pch = 20)
points(md$d08/10,md$dryweight.kg, col = "green", pch = 20)
points(md$d10/10,md$dryweight.kg, col = "green3", pch = 20)
lines(x,0.4255*x^1.685) #mm2
plot(c(,), col = "darkred", pch = 20, xlim = c(0,18), ylim = c(0,80), xlab = "Diameter (cm)", ylab = "Culm dry mass (kg)")
plot(c(), col = "darkred", pch = 20, xlim = c(0,18), ylim = c(0,80), xlab = "Diameter (cm)", ylab = "Culm dry mass (kg)")
points(md$dryweight.kg~md$dap, col = "darkred", pch = 20)
plot(c(), col = "darkred", pch = 20, xlim = c(0,18), ylim = c(0,80), xlab = "Diameter at breast height (cm)", ylab = "Culm dry mass (kg)")
points(md$dryweight.kg~md$dap, col = "darkred", pch = 20)
plot(c(), col = "darkred", pch = 20, xlim = c(0,18), ylim = c(0,80), xlab = "Diameter at breast height (cm)", ylab = "Culm dry mass (kg)")
points(md$d06/10,md$dryweight.kg, col = "yellow4", pch = 20)
plot(c(), col = "darkred", pch = 20, xlim = c(0,18), ylim = c(0,80), xlab = "Diameter at height 6 m (cm)", ylab = "Culm dry mass (kg)")
points(md$d06/10,md$dryweight.kg, col = "yellow4", pch = 20)
plot(c(), col = "darkred", pch = 20, xlim = c(0,18), ylim = c(0,80), xlab = "Diameter at height 10 m (cm)", ylab = "Culm dry mass (kg)")
points(md$d10/10,md$dryweight.kg, col = "green3", pch = 20)
points(md$d12/10,md$dryweight.kg, col = "green3", pch = 20)
plot(c(), col = "darkred", pch = 20, xlim = c(0,18), ylim = c(0,80), xlab = "Diameter at height 10 m (cm)", ylab = "Culm dry mass (kg)")
points(md$d12/10,md$dryweight.kg, col = "green3", pch = 20)
points(md$d10/10,md$dryweight.kg, col = "green3", pch = 20)
plot(c(), col = "darkred", pch = 20, xlim = c(0,18), ylim = c(0,80), xlab = "Diameter at height 10 m (cm)", ylab = "Culm dry mass (kg)")
grid()
points(md$d10/10,md$dryweight.kg, col = "green4", pch = 20)
plot(c(), col = "darkred", pch = 20, xlim = c(0,18), ylim = c(0,80), xlab = "Diameter at height 10 m (cm)", ylab = "Culm dry mass (kg)")
grid()
points(md$d10/10,md$dryweight.kg, col = "green4", pch = 20)
summary(mm1)
mm4 <- nls(dryweight.kg ~ a * d06^b, start = c(a = 0.35, b = 2.5))
summary(mm4)
summary(mm3)
AIC(mm1, mm2, mm3, mm4)
AIC(mm1, mm3, mm4)
A <- [12,23,34,45]
A <- c(12,23,34,45)
B <- c(10, 23, 34, 45)
A == B
count(A==B)
sum(A==B)
c <- c(12,20, 30, 45)
sum(A==C)
C <- c(12,20, 30, 45)
sum(A==C)
# korrigieren um den Volumenverlust bei der Vielecks-Darstellung
polygon_factor = c()
for (n in 3:50) {
alpha <- pi / n
area <- n*cos(alpha)*sin(alpha)
polygon_factor[n] <- area/pi
}
polygon_factor
polygon_factor[20]
polygon_factor[30]
polygon_factor[10]
polygon_factor[8]
polygon_factor[5]
polygon_factor[50]
setwd('/home/timon/fit_programming_III/Results')
#-----
# create joint table off all results with its settings
ar <- data.frame() # ar = allresults
for(i in 1:1656){
filename <- paste0("Results", i, ".csv")
r <- read.csv(filename)
r$con <- i
ar <- rbind(ar,r)
}
settings <- read.csv('~/fit_programming_III/Settings/Settings9756.csv')
alr <- merge(x = ar, y = settings, by.x = "con", by.y = "settings_id", all.x = T)
# read stem sets
allstemfiles <- list.files('~/fit_programming_III/Stems')
stemdata <- data.frame()
for(file in allstemfiles){
set <- read.csv(paste0('~/fit_programming_III/Stems/', file))
number <- nrow(set)
length.mean <- mean(set$length)
length.sd <- sd(set$length)
taper.mean <- mean((set$bottom_diam_x-set$top_diam_x)/set$length)*100 # unit: cm per m
taper.sd <- sd((set$bottom_diam_x-set$top_diam_x)/set$length)*100
mdiam.mean <- mean(set$middle_diam_x)
mdiam.sd <- sd(set$middle_diam_x)
ellipticity.mean <- mean(set$middle_diam_y/set$middle_diam_x)
ellipticity.sd <- sd(set$middle_diam_y/set$middle_diam_x)
bend.mean <- mean(set$bend)
bend.sd <- mean(set$bend)
bent.frac <- sum(set$bend != 0)/nrow(set)
if(sum(set$bend != 0) > 0){
bentset <- set[which(set$bend != 0), ]
bentbend.mean <- mean(bentset$bend)
bentbend.sd <- sd(bentset$bend)
}else{
bentbend.mean <- 0
bentbend.sd <- 0
}
stemdata <- rbind(stemdata, c(number, length.mean, length.sd, taper.mean, taper.sd,
mdiam.mean, mdiam.sd, ellipticity.mean, ellipticity.sd,
bend.mean, bend.sd, bent.frac, bentbend.mean, bentbend.sd))
}
stemdata$stemfile <- allstemfiles
names(stemdata) <- c("stems.number", "stems.length.mean", "stems.length.sd",
"stems.taper.mean", "stems.taper.sd",
"stems.diam.mean", "stems.diam.sd", "stems.ellipt.mean", "stems.ellipt.sd",
"stems.bend.mean", "stems.bend.sd", "stems.bent.frac.",
"stems.bentbend.mean", "stems.bentbend.sd", "stemfile")
a <- merge(alr, stemdata, by.x = "stem_file", by.y = "stemfile")
# finished generating stem info
con.res <- merge(settings, aggregate(ar, by = list(ar$con), FUN = mean), by.x = "settings_id", by.y = "con", all.x = F)
con.res$Deflation.Factor <- con.res$Net.Volume/con.res$Gross.Volume
usable <- a[ which(!(a$stems.bentbend.mean > 0.5) & (a$stems.taper.mean < 10)), ]
11880/20
plot(usable$Dislocated.any.)
plot(usable$Dislocated.any., col = usable$drop_algorithm)
View(usable)
View(stemdata)
View(stemdata)
c("hallo", 2,3)
stemdata <- data.frame()
for(file in allstemfiles){
set <- read.csv(paste0('~/fit_programming_III/Stems/', file))
number <- nrow(set)
length.mean <- mean(set$length)
length.sd <- sd(set$length)
taper.mean <- mean((set$bottom_diam_x-set$top_diam_x)/set$length)*100 # unit: cm per m
taper.sd <- sd((set$bottom_diam_x-set$top_diam_x)/set$length)*100
mdiam.mean <- mean(set$middle_diam_x)
mdiam.sd <- sd(set$middle_diam_x)
ellipticity.mean <- mean(set$middle_diam_y/set$middle_diam_x)
ellipticity.sd <- sd(set$middle_diam_y/set$middle_diam_x)
bend.mean <- mean(set$bend)
bend.sd <- mean(set$bend)
bent.frac <- sum(set$bend != 0)/nrow(set)
if(sum(set$bend != 0) > 0){
bentset <- set[which(set$bend != 0), ]
bentbend.mean <- mean(bentset$bend)
bentbend.sd <- sd(bentset$bend)
}else{
bentbend.mean <- 0
bentbend.sd <- 0
}
stemdata <- rbind(stemdata, c(file, number, length.mean, length.sd, taper.mean, taper.sd,
mdiam.mean, mdiam.sd, ellipticity.mean, ellipticity.sd,
bend.mean, bend.sd, bent.frac, bentbend.mean, bentbend.sd))
}
stemdata <- data.frame()
for(file in allstemfiles){
set <- read.csv(paste0('~/fit_programming_III/Stems/', file))
number <- nrow(set)
length.mean <- mean(set$length)
length.sd <- sd(set$length)
taper.mean <- mean((set$bottom_diam_x-set$top_diam_x)/set$length)*100 # unit: cm per m
taper.sd <- sd((set$bottom_diam_x-set$top_diam_x)/set$length)*100
mdiam.mean <- mean(set$middle_diam_x)
mdiam.sd <- sd(set$middle_diam_x)
ellipticity.mean <- mean(set$middle_diam_y/set$middle_diam_x)
ellipticity.sd <- sd(set$middle_diam_y/set$middle_diam_x)
bend.mean <- mean(set$bend)
bend.sd <- mean(set$bend)
bent.frac <- sum(set$bend != 0)/nrow(set)
if(sum(set$bend != 0) > 0){
bentset <- set[which(set$bend != 0), ]
bentbend.mean <- mean(bentset$bend)
bentbend.sd <- sd(bentset$bend)
}else{
bentbend.mean <- 0
bentbend.sd <- 0
}
stemdata <- rbind(stemdata, c(number, length.mean, length.sd, taper.mean, taper.sd,
mdiam.mean, mdiam.sd, ellipticity.mean, ellipticity.sd,
bend.mean, bend.sd, bent.frac, bentbend.mean, bentbend.sd))
}
stemdata$stemfile <- allstemfiles
names(stemdata) <- c("stems.number", "stems.length.mean", "stems.length.sd",
"stems.taper.mean", "stems.taper.sd",
"stems.diam.mean", "stems.diam.sd", "stems.ellipt.mean", "stems.ellipt.sd",
"stems.bend.mean", "stems.bend.sd", "stems.bent.frac.",
"stems.bentbend.mean", "stems.bentbend.sd", "stemfile")
set
set$bottom_diam_x-set$top_diam_x)/set$length
install.packages("tidyr")
allstemfiles <- list.files()
stem_file <- c( allstemfiles[which( substr(allstemfiles,0,5) == "My200")], "Darre_neu.csv", "BB10_2019.csv")
# first for all stem sets with fewer parameter variations
setwd('/home/timon/fit_programming_III/Stems')
allstemfiles <- list.files()
stem_file <- c( allstemfiles[which( substr(allstemfiles,0,5) == "My200")], "Darre_neu.csv", "BB10_2019.csv")
file <- "MyStems.csv"
my <- read.csv(file)
taper.mean <- mean((my$bottom_diam_x-my$top_diam_x)/my$length)*100
setwd('/home/timon/fit_programming_III/Stems')
my <- read.csv(file)
allstemfiles
file <- "MySmallMixedStems.csv"
my <- read.csv(file)
taper.mean <- mean((my$bottom_diam_x-my$top_diam_x)/my$length)*100
bentbend.mean <- mean(my[which(my$bend > 0),]$bend)
#correct all stem files
setwd('/home/timon/fit_programming_III/Stems')
allstemfiles <- list.files()
stem_file <- c( allstemfiles[which( substr(allstemfiles,0,5) == "My200")], "Darre_neu.csv", "BB10_2019.csv")
for (file in stem_file) {´
my <- read.csv(file)
taper.mean <- mean((my$bottom_diam_x-my$top_diam_x)/my$length)*100
bentbend.mean <- mean(my[which(my$bend > 0),]$bend)
if(taper.mean > 5){
my$bottom_diam_x <- my$middle_diam_x + (my$bottom_diam_x-my$middle_diam_x)/100
my$bottom_diam_y <- my$middle_diam_y + (my$bottom_diam_y - my$middle_diam_y)/100
my$top_diam_x <- my$middle_diam_x - (my$middle_diam_x-my$top_diam_x)/100
my$top_diam_y <- my$middle_diam_y - (my$middle_diam_y-my$top_diam_y)/100
}
if(bentbend.mean > 0.5){
my$bend <- my$bend/100
}
}
for (file in stem_file) {
my <- read.csv(file)
taper.mean <- mean((my$bottom_diam_x-my$top_diam_x)/my$length)*100
bentbend.mean <- mean(my[which(my$bend > 0),]$bend)
if(taper.mean > 5){
my$bottom_diam_x <- my$middle_diam_x + (my$bottom_diam_x-my$middle_diam_x)/100
my$bottom_diam_y <- my$middle_diam_y + (my$bottom_diam_y - my$middle_diam_y)/100
my$top_diam_x <- my$middle_diam_x - (my$middle_diam_x-my$top_diam_x)/100
my$top_diam_y <- my$middle_diam_y - (my$middle_diam_y-my$top_diam_y)/100
}
if(bentbend.mean > 0.5){
my$bend <- my$bend/100
}
}
mybent <- my[which(my$bend > 0),]
for (file in stem_file) {
my <- read.csv(file)
taper.mean <- mean((my$bottom_diam_x-my$top_diam_x)/my$length)*100
mybent <- my[which(my$bend > 0),]
if(nrow(mybent)>0){
bentbend.mean <- mean($bend)
}else{
bentbend.mean <- 0
}
if(taper.mean > 5){
my$bottom_diam_x <- my$middle_diam_x + (my$bottom_diam_x-my$middle_diam_x)/100
my$bottom_diam_y <- my$middle_diam_y + (my$bottom_diam_y - my$middle_diam_y)/100
my$top_diam_x <- my$middle_diam_x - (my$middle_diam_x-my$top_diam_x)/100
my$top_diam_y <- my$middle_diam_y - (my$middle_diam_y-my$top_diam_y)/100
}
if(bentbend.mean > 0.5){
my$bend <- my$bend/100
}
}
for (file in stem_file) {
my <- read.csv(file)
taper.mean <- mean((my$bottom_diam_x-my$top_diam_x)/my$length)*100
mybent <- my[which(my$bend > 0),]
if(nrow(mybent)>0){
bentbend.mean <- mean($bend)
}else{
bentbend.mean <- 0
}
if(taper.mean > 5){
my$bottom_diam_x <- my$middle_diam_x + (my$bottom_diam_x-my$middle_diam_x)/100
my$bottom_diam_y <- my$middle_diam_y + (my$bottom_diam_y - my$middle_diam_y)/100
my$top_diam_x <- my$middle_diam_x - (my$middle_diam_x-my$top_diam_x)/100
my$top_diam_y <- my$middle_diam_y - (my$middle_diam_y-my$top_diam_y)/100
}
if(bentbend.mean > 0.5){
my$bend <- my$bend/100
}
}
for (file in stem_file){
my <- read.csv(file)
taper.mean <- mean((my$bottom_diam_x-my$top_diam_x)/my$length)*100
mybent <- my[which(my$bend > 0),]
if(nrow(mybent)>0){
bentbend.mean <- mean($bend)
}else{
bentbend.mean <- 0
}
if(taper.mean > 5){
my$bottom_diam_x <- my$middle_diam_x + (my$bottom_diam_x-my$middle_diam_x)/100
my$bottom_diam_y <- my$middle_diam_y + (my$bottom_diam_y - my$middle_diam_y)/100
my$top_diam_x <- my$middle_diam_x - (my$middle_diam_x-my$top_diam_x)/100
my$top_diam_y <- my$middle_diam_y - (my$middle_diam_y-my$top_diam_y)/100
}
if(bentbend.mean > 0.5){
my$bend <- my$bend/100
}
}
bentbend.mean <- ifelse(nrow(mybent)>0), mean($bend), 0)
bentbend.mean <- ifelse(nrow(mybent)>0, mean($bend), 0)
bentbend.mean <- ifelse(nrow(mybent)>0, mean(mybent$bend), 0)
for (file in stem_file){
my <- read.csv(file)
taper.mean <- mean((my$bottom_diam_x-my$top_diam_x)/my$length)*100
mybent <- my[which(my$bend > 0),]
bentbend.mean <- ifelse(nrow(mybent)>0, mean(mybent$bend), 0)
}
allstemfiles<-stem_file
stemdata <- data.frame()
for(file in allstemfiles){
set <- read.csv(paste0('~/fit_programming_III/Stems/', file))
number <- nrow(set)
length.mean <- mean(set$length)
length.sd <- sd(set$length)
taper.mean <- mean((set$bottom_diam_x-set$top_diam_x)/set$length)*100 # unit: cm per m
taper.sd <- sd((set$bottom_diam_x-set$top_diam_x)/set$length)*100
mdiam.mean <- mean(set$middle_diam_x)
mdiam.sd <- sd(set$middle_diam_x)
ellipticity.mean <- mean(set$middle_diam_y/set$middle_diam_x)
ellipticity.sd <- sd(set$middle_diam_y/set$middle_diam_x)
bend.mean <- mean(set$bend)
bend.sd <- mean(set$bend)
bent.frac <- sum(set$bend != 0)/nrow(set)
if(sum(set$bend != 0) > 0){
bentset <- set[which(set$bend != 0), ]
bentbend.mean <- mean(bentset$bend)
bentbend.sd <- sd(bentset$bend)
}else{
bentbend.mean <- 0
bentbend.sd <- 0
}
stemdata <- rbind(stemdata, c(number, length.mean, length.sd, taper.mean, taper.sd,
mdiam.mean, mdiam.sd, ellipticity.mean, ellipticity.sd,
bend.mean, bend.sd, bent.frac, bentbend.mean, bentbend.sd))
}
stemdata$stemfile <- allstemfiles
names(stemdata) <- c("stems.number", "stems.length.mean", "stems.length.sd",
"stems.taper.mean", "stems.taper.sd",
"stems.diam.mean", "stems.diam.sd", "stems.ellipt.mean", "stems.ellipt.sd",
"stems.bend.mean", "stems.bend.sd", "stems.bent.frac.",
"stems.bentbend.mean", "stems.bentbend.sd", "stemfile")
#check
hist(stemdata$stems.taper.mean)
for (file in stem_file){
my <- read.csv(file)
taper.mean <- mean((my$bottom_diam_x-my$top_diam_x)/my$length)*100
mybent <- my[which(my$bend > 0),]
bentbend.mean <- ifelse(nrow(mybent)>0, mean(mybent$bend), 0)
}
for (file in stem_file){
my <- read.csv(file)
taper.mean <- mean((my$bottom_diam_x-my$top_diam_x)/my$length)*100
mybent <- my[which(my$bend > 0),]
bentbend.mean <- ifelse(nrow(mybent)>0, mean(mybent$bend), 0)
if(taper.mean > 5){
my$bottom_diam_x <- my$middle_diam_x + (my$bottom_diam_x-my$middle_diam_x)/100
my$bottom_diam_y <- my$middle_diam_y + (my$bottom_diam_y - my$middle_diam_y)/100
my$top_diam_x <- my$middle_diam_x - (my$middle_diam_x-my$top_diam_x)/100
my$top_diam_y <- my$middle_diam_y - (my$middle_diam_y-my$top_diam_y)/100
}
if(bentbend.mean > 0.5){
my$bend <- my$bend/100
}
write.csv(my,file, row.names = F)
}
stemdata <- data.frame()
for(file in allstemfiles){
set <- read.csv(paste0('~/fit_programming_III/Stems/', file))
number <- nrow(set)
length.mean <- mean(set$length)
length.sd <- sd(set$length)
taper.mean <- mean((set$bottom_diam_x-set$top_diam_x)/set$length)*100 # unit: cm per m
taper.sd <- sd((set$bottom_diam_x-set$top_diam_x)/set$length)*100
mdiam.mean <- mean(set$middle_diam_x)
mdiam.sd <- sd(set$middle_diam_x)
ellipticity.mean <- mean(set$middle_diam_y/set$middle_diam_x)
ellipticity.sd <- sd(set$middle_diam_y/set$middle_diam_x)
bend.mean <- mean(set$bend)
bend.sd <- mean(set$bend)
bent.frac <- sum(set$bend != 0)/nrow(set)
if(sum(set$bend != 0) > 0){
bentset <- set[which(set$bend != 0), ]
bentbend.mean <- mean(bentset$bend)
bentbend.sd <- sd(bentset$bend)
}else{
bentbend.mean <- 0
bentbend.sd <- 0
}
stemdata <- rbind(stemdata, c(number, length.mean, length.sd, taper.mean, taper.sd,
mdiam.mean, mdiam.sd, ellipticity.mean, ellipticity.sd,
bend.mean, bend.sd, bent.frac, bentbend.mean, bentbend.sd))
}
stemdata$stemfile <- allstemfiles
names(stemdata) <- c("stems.number", "stems.length.mean", "stems.length.sd",
"stems.taper.mean", "stems.taper.sd",
"stems.diam.mean", "stems.diam.sd", "stems.ellipt.mean", "stems.ellipt.sd",
"stems.bend.mean", "stems.bend.sd", "stems.bent.frac.",
"stems.bentbend.mean", "stems.bentbend.sd", "stemfile")
#check
hist(stemdata$stems.taper.mean)
hist(stemdata$stems.bend.mean)
hist(stemdata$stems.diam.mean)
